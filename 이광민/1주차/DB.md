## DEADLOCK
- 동일 작업을 공유하고 있는 두 개 이상의 작업이 서로의 작업을 진행하기 위해서 교착 상태에 빠진 상태

<img width="306" alt="image" src="https://user-images.githubusercontent.com/43610417/222869524-15493eef-7c34-48f8-be2d-fb255af8d343.png">

- 위의 그림에서 서로 식사를 하기 위해서는 옆 사람의 젓가락을 사용해야 하지만 모두가 식사를 하고 싶기에 다른 사람들이 젓가락을 놓기를 기다려야 한다 그렇기에 모든 작업이 중지되는 것이기에 **DEADLOCK**이라고 볼 수 있다.

## Transaction
- 트랜잭션이란 데이터베이스의 상태를 변환시키는 기능을 수행하기 위한 하나 이상의 쿼리를 모아 놓은 하나의 작업 단위를 말한다.
### ACID
- ACID는 데이터베이스 내에서 일어나는 하나의 트랜잭션(transaction)의 안전성을 보장하기 위해 필요한 성질이다.
### Atomicity(원자성)
- 원자성이란 시스템에서 한 트랜잭션의 연산들이 모두 성공하거나, 반대로 전부 실패되는 성질을 말한다.
- 원자성은 작업이 모두 반영되거나 모두 반영되지 않음으로서 결과를 예측할 수 있어야 한다.
- 계좌 이체를 예로 들어 설명
  - A 계좌에서 출금
  - B 계좌에 입금
  - 출금은 일어났지만 입금이 되지 않았다면 모든 작업이 실패로 돌아가야 한다는 것이 원자성이다.
  - 하지만 모든 작업을 언제나 롤백시키는 경우 자원의 소모가 크기에 충돌 요인에 대해 선택지를 제공한다.
### Consistency(일관성)
- 일관성은 데이터베이스의 상태가 일관되어야 한다는 성질이다.
- 모든 고객이 이름을 가지고 있어야 한다는 제약이 존재하면 이름이 없는 고객을 추가하거나 고객의 이름을 삭제하는 쿼리는 일관성을 위반한다고 볼 수 있다.
### Isolation(격리성, 고립성)
- 격리성은 모든 트랜잭션은 다른 트랜잭션으로부터 독립되어야 한다는 뜻이다.
- 계좌에 만원이 있을 시 B로 7천 원, C로 7천 원을 동시에 이체할 시 B에 먼저 송근하고 C에 보내는 결과와 동일해야 한다.
- 격리성을 지키는 트랜젝션은 서로 독립적이기에 다른 트랜젝션의 작업을 알 수 없어야 한다.
### Durability(지속성)
- 지속성은 하나의 트랜잭션이 성공적으로 수행되었다면, 해당 트랜잭션에 대한 로그가 남아야하는 성질을 말한다.
- 은행에서 이체에 성공하고 은행 DB가 오류가 발생해 종료되더라도 이체 내역은 남아있어야 한다.
- 이체를 로그로 기록하기 전에 시스템이 종료 된다면 이체 내역은 실패로 돌아가고 계좌들은 이체 이전 상태로 돌아가야 한다.
## isolation level
### READ UNCOMMITTED
- COMMIT과 상관없이 다른 트랜잭션에 보여진다.
- A트랜잭션에서 10번 사원 나이를 27살에서 28살로 바꾸고 커밋하지 않아도 B트랜잭션에서는 10번 사원의 나이를 조회하면 28살이라고 조회된다.(더티 리드)이며 정합성에 위반된다.
### READ COMMITTED
- 트랜잭션의 변경 내용이 COMMIT 되어야만 다른 트랜잭션에서 조회할 수 있다.
- A트랜잭션에서 10번 사원 나이를 27살에서 28살로 바꾸고 커밋하지 상태에서 B트랜잭션에서는 10번 사원의 나이를 조회하면 27살이라고 조회되며
- A트랜잭션에서 커밋을 한 후 B트랜잭션에서는 10번 사원의 나이를 조회하면 28살이라고 조회된다.
- 하지만 이 부분에서 입금 총 합을 보여주는 트랜잭션이 있다면 SELECT 쿼리마다 다른 값을 보여주기에 정합성에 위반된다.
### REPEATABLE READ
- 트랜잭션이 시작되지 전에 커밋된 내용에 대해서만 조회가 가능하다.
### SERIALIZABLE
- 가장 엄격한 격리 수준으로 읽기 작업에도 공유 잠금을 설정하여 동시에 다른 트랜잭션에서 이 레코드르 변경하지 못하게 한다.
- https://joont92.github.io/db/%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EA%B2%A9%EB%A6%AC-%EC%88%98%EC%A4%80-isolation-level/
